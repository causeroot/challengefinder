container_commands:
  01bundle-install:
    command: "su ec2-user -c 'bundle install'"
  04asscom:
    command: "su ec2-user -c 'bundle exec rake assets:precompile'"    
  create_post_dir:
    command: "mkdir -p /opt/elasticbeanstalk/hooks/appdeploy/post"
    ignoreErrors: true   

files:
  "/opt/elasticbeanstalk/hooks/appdeploy/post/99_start_solr.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
        #!/bin/bash -l
        cd /var/app/current
        bundle exec rake db:migrate
        bundle exec rake sunspot:solr:start
        bundle exec rake db:seed
